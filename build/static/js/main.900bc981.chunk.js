(this["webpackJsonpview-unsplash"]=this["webpackJsonpview-unsplash"]||[]).push([[0],{34:function(e,t,a){},36:function(e,t,a){e.exports={lds_ellipsis:"Preloader_lds_ellipsis__3XaBd",lds_ellipsis1:"Preloader_lds_ellipsis1__1UdGx",lds_ellipsis2:"Preloader_lds_ellipsis2__20xGS",lds_ellipsis3:"Preloader_lds_ellipsis3__1fY-o"}},37:function(e,t,a){e.exports=a(67)},42:function(e,t,a){},47:function(e,t,a){},48:function(e,t,a){},63:function(e,t,a){},65:function(e,t,a){},66:function(e,t,a){},67:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(17),c=a.n(i),o=(a(42),a(3)),l=a(19),s=a(20),u=a(23),m=a(22),p=a(9),h=(a(47),a(36)),d=a.n(h),E=function(){return r.a.createElement("div",{className:d.a.lds_ellipsis},r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null))},f=function(e){var t=e.width,a=e.height,n=e.fill;return r.a.createElement("svg",{id:"Capa_1",enableBackground:"new 0 0 391.837 391.837;",height:a,viewBox:"0 0 391.837 391.837",width:t,fill:n,xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("g",null,r.a.createElement("g",null,r.a.createElement("path",{d:"M285.257,35.528c58.743,0.286,106.294,47.836,106.58,106.58\r c0,107.624-195.918,214.204-195.918,214.204S0,248.165,0,142.108c0-58.862,47.717-106.58,106.58-106.58l0,0\r c36.032-0.281,69.718,17.842,89.339,48.065C215.674,53.517,249.273,35.441,285.257,35.528z"}))))},_=(a(48),function(){return r.a.createElement("div",{className:"alert"},"\u0412\u044b \u043d\u0435 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u044b!")}),v=function(e){var t=e.image,a=e.photoId,n=e.likedClick,i=e.unlikeClick,c=e.err;return t&&a===t.id?r.a.createElement(r.a.Fragment,null,c&&r.a.createElement(_,null),r.a.createElement("div",{className:"photo"},r.a.createElement("img",{src:t.urls.regular,alt:t.alt_desckription}),r.a.createElement("div",{className:"photo__content"},r.a.createElement("h3",{className:"photo__name"},t.user.name),r.a.createElement("div",{onClick:t.liked_by_user?i:n,className:"photo__like"},r.a.createElement(f,{width:20,height:18,fill:t.liked_by_user?"#e75a5a":"gainsboro"}),r.a.createElement("span",null,t.likes))))):r.a.createElement(E,null)},g=a(11),b=a.n(g),k=a(10),O=a.n(k),A=new b.a({accessKey:"CCmUYdJ0XloimmGTAqnof5xFLlD27kNQiDo5pNEnVQ4",secret:"aXJI2FFI1YJW0DDPXoxyJJ2YFgG_ni0zAbMGw1kSwO4",callbackUrl:"http://localhost:3000",bearerToken:"undefined"!==O.a.get("access_token")?O.a.get("access_token"):""}),w=A.auth.getAuthenticationUrl(["public","read_user","write_user","read_photos","write_photos","write_likes","write_followers","read_collections","write_collections"]),j=function(){return A.currentUser.profile().then(g.toJson).then((function(e){return e}))},y=function(e){return A.photos.getPhoto(e).then(g.toJson).then((function(e){return e}))},M=function(e){return A.photos.likePhoto(e).then(g.toJson).then((function(e){return e}))},T=function(e){return A.photos.unlikePhoto(e).then(g.toJson).then((function(e){return e}))},N=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).setErrActive=function(t){e.props.setErr(t)},e.likedClick=function(){e.props.isAuth?M(e.props.photoId).then((function(t){e.props.setLiked(t.photo.likes)})):(e.setErrActive(!0),setTimeout(e.setErrActive,3e3))},e.unlikeClick=function(){e.props.isAuth?T(e.props.photoId).then((function(t){e.props.setLiked(t.photo.likes)})):(e.setErrActive(!0),setTimeout(e.setErrActive,3e3))},e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var e=this;y(this.props.photoId).then((function(t){e.props.setImage(t)}))}},{key:"componentDidUpdate",value:function(e,t,a){var n=this;e.image&&this.props.image.likes!==e.image.likes&&y(this.props.photoId).then((function(e){n.props.setImage(e)}))}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(v,{err:this.props.err,isAuth:this.props.isAuth,image:this.props.image,photoId:this.props.photoId,likedClick:this.likedClick,unlikeClick:this.unlikeClick}))}}]),a}(r.a.Component),I=Object(p.b)((function(e){return{image:e.photos.image,token:e.auth.token,isAuth:e.auth.isAuth,err:e.auth.err}}),(function(e){return{setImage:function(t){return e(function(e,t){return{type:"SET_IMAGE",payload:e,page:t}}(t))},setLiked:function(t){return e({type:"SET_LIKED",payload:t})},setErr:function(t){return e(function(e){return{type:"SET_ERR",payload:e}}(t))}}}))(N),S=(a(63),a(34),a(8)),C=function(e){var t=e.width,a=e.height,n=e.fill;return r.a.createElement("svg",{id:"Capa_1",enableBackground:"new 0 0 490.3 490.3;",height:a,viewBox:"0 0 490.3 490.3",width:t,fill:n,xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("g",null,r.a.createElement("g",null,r.a.createElement("path",{d:"M0,121.05v248.2c0,34.2,27.9,62.1,62.1,62.1h200.6c34.2,0,62.1-27.9,62.1-62.1v-40.2c0-6.8-5.5-12.3-12.3-12.3\r s-12.3,5.5-12.3,12.3v40.2c0,20.7-16.9,37.6-37.6,37.6H62.1c-20.7,0-37.6-16.9-37.6-37.6v-248.2c0-20.7,16.9-37.6,37.6-37.6h200.6\r c20.7,0,37.6,16.9,37.6,37.6v40.2c0,6.8,5.5,12.3,12.3,12.3s12.3-5.5,12.3-12.3v-40.2c0-34.2-27.9-62.1-62.1-62.1H62.1\r C27.9,58.95,0,86.75,0,121.05z"}),r.a.createElement("path",{d:"M385.4,337.65c2.4,2.4,5.5,3.6,8.7,3.6s6.3-1.2,8.7-3.6l83.9-83.9c4.8-4.8,4.8-12.5,0-17.3l-83.9-83.9\r c-4.8-4.8-12.5-4.8-17.3,0s-4.8,12.5,0,17.3l63,63H218.6c-6.8,0-12.3,5.5-12.3,12.3c0,6.8,5.5,12.3,12.3,12.3h229.8l-63,63\r C380.6,325.15,380.6,332.95,385.4,337.65z"}))))},L=function(e){var t=e.profileMi,a=e.clickMenuAvatar,n=e.classNames,i=e.getAuthentication,c=e.setLogout;return r.a.createElement("header",{className:"header"},r.a.createElement("div",{className:"menu"},r.a.createElement(S.b,{to:"/"},"Home"),t&&r.a.createElement(S.b,{to:"/profile"},"\u041f\u0440\u043e\u0444\u0438\u043b\u044c")),r.a.createElement("div",{className:"header_avatar"},t?r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{onClick:a,src:t.profile_image.small,alt:t.name}),r.a.createElement("div",{className:n},r.a.createElement("div",{className:"avatar__menu_profile"},r.a.createElement("img",{src:t.profile_image.small,alt:t.name}),r.a.createElement("div",null,t.first_name)),r.a.createElement("div",{className:"avatar__menu"},r.a.createElement(S.b,{onClick:a,to:"/"},"Home"),r.a.createElement(S.b,{onClick:a,to:"/profile"},"\u041f\u0440\u043e\u0444\u0438\u043b\u044c")),r.a.createElement("button",{onClick:c,className:"button__logout"},"\u0412\u044b\u0439\u0442\u0438",r.a.createElement(C,{width:20,height:20})))):r.a.createElement("button",{onClick:i,className:"button__login"},"\u0412\u0445\u043e\u0434")))},P=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).clickMenuAvatar=function(){e.props.setActiveMenuAvatar(!e.props.activeMenuAvatar)},e.code=window.location.search.split("code=")[1],e.logout=function(){O.a.set("access_token","",{expires:-1}),e.props.setLogout()},e}return Object(s.a)(a,[{key:"enterAuthorization",value:function(){window.location.assign(w)}},{key:"componentDidMount",value:function(){var e=this;O.a.get("access_token")?j().then((function(t){e.props.setProfileMi(t),e.props.setIsAuth(!0)})):this.code&&A.auth.userAuthentication(this.code).then((function(e){return e.json()})).then((function(t){A.auth.setBearerToken(t.access_token),O.a.set("access_token",t.access_token,{expires:3600}),j().then((function(t){e.props.setProfileMi(t),e.props.setIsAuth(!0)}))}))}},{key:"render",value:function(){var e="logout";return this.props.activeMenuAvatar&&(e+=" active"),r.a.createElement(L,{clickMenuAvatar:this.clickMenuAvatar,classNames:e,getAuthentication:this.enterAuthorization,profileMi:this.props.profileMi,setLogout:this.logout})}}]),a}(r.a.Component),x=Object(p.b)((function(e){return{isAuth:e.auth.isAuth,profileMi:e.auth.profileMi,activeMenuAvatar:e.auth.activeMenuAvatar}}),(function(e){return{setProfileMi:function(t){return e(function(e){return{type:"SET_PROFILE_MI",payload:e}}(t))},setIsAuth:function(t){return e(function(e){return{type:"SET_IS_AUTH",payload:e}}(t))},setLogout:function(){return e({type:"SET_LOGOUT"})},setActiveMenuAvatar:function(t){return e(function(e){return{type:"SET_ACTIVE_MENU_AVATAR",payload:e}}(t))}}}))(P),U=function(e){var t=e.profileMi;return r.a.createElement("div",{className:"profile"},r.a.createElement("div",{className:"profile_image"},r.a.createElement("img",{src:t.profile_image.large,alt:t.name}),r.a.createElement("div",{className:"profile_data"},r.a.createElement("h1",null,t.name),r.a.createElement("div",null,t.email))),r.a.createElement("div",{className:"profile_photos"}))},D=Object(p.b)((function(e){return{profileMi:e.auth.profileMi}}))((function(e){var t=e.profileMi;return t?r.a.createElement(U,{profileMi:t}):r.a.createElement(o.a,{to:"/"})})),G=a(28),J=(a(65),a(66),function(e){return r.a.createElement("li",{className:"card"},r.a.createElement(S.b,{to:"/image/".concat(e.image.id)},r.a.createElement("img",{src:e.image.urls.small,alt:e.image.alt_description})),r.a.createElement("div",{className:"card__content"},r.a.createElement("h3",{className:"card__name"},e.image.user.name),r.a.createElement("div",{className:"card__like"},r.a.createElement(f,{width:16,height:14,fill:e.image.liked_by_user?"#e75a5a":"white"}),r.a.createElement("span",null,e.image.likes))))}),R=a(29),B=a(1),F=Object(n.createContext)(),H={images:[],page:1,per_page:10},X=function(e,t){switch(t.type){case"SET_IMAGES":return Object(B.a)(Object(B.a)({},e),{},{images:[].concat(Object(R.a)(e.images),Object(R.a)(t.payload))});case"SET_PAGE":return Object(B.a)(Object(B.a)({},e),{},{page:e.page+t.payload});default:return e}},V=function(){var e=Object(n.useContext)(F).state;return e.images?r.a.createElement("div",{className:"photos__wrapper"},r.a.createElement("ul",{className:"photos"},e.images.map((function(e){return r.a.createElement(J,{key:e.id,image:e})})))):r.a.createElement(E,null)},z=function(){var e=Object(n.useReducer)(X,H),t=Object(G.a)(e,2),a=t[0],i=t[1],c=Object(n.useState)(!1),o=Object(G.a)(c,2),l=o[0],s=o[1];function u(){var e=document.documentElement.getBoundingClientRect().bottom,t=document.documentElement.clientHeight;e-t<500&&s(!0),e-t>=500&&s(!1)}return Object(n.useEffect)((function(){(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return A.photos.listPhotos(e,t,"latest").then(g.toJson).then((function(e){return e}))})(a.page,a.per_page).then((function(e){i({payload:e,type:"SET_IMAGES"})}))}),[a.page,a.per_page]),Object(n.useEffect)((function(){return window.addEventListener("scroll",u),function(){window.removeEventListener("scroll",u)}})),Object(n.useEffect)((function(){l&&i({payload:1,type:"SET_PAGE"})}),[l]),r.a.createElement(F.Provider,{value:{dispatch:i,state:a}},r.a.createElement(V,null))},K=function(){return r.a.createElement("div",{className:"container"},r.a.createElement(x,null),r.a.createElement("main",{className:"main"},r.a.createElement(o.d,null,r.a.createElement(o.b,{exact:!0,path:"/",component:z}),r.a.createElement(o.b,{exact:!0,path:"/image/:id",render:function(e){var t=e.match;return r.a.createElement(I,{photoId:t.params.id})}}),r.a.createElement(o.b,{exact:!0,path:"/profile",component:D}),r.a.createElement(o.a,{to:"/"}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Y=a(13),W={isAuth:!1,profileMi:null,err:!1,activeMenuAvatar:!1},Q={image:null,like:!1,loading:!1},q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_IMAGE":return Object(B.a)(Object(B.a)({},e),{},{image:t.payload});case"SET_UPDATE_IMAGE":return Object(B.a)(Object(B.a)({},e),{},{image:Object(B.a)(Object(B.a)({},e.image),{},{liked_by_user:t.payload.liked_by_user})});case"SET_LIKED":return Object(B.a)(Object(B.a)({},e),{},{image:Object(B.a)(Object(B.a)({},e.image),{},{likes:t.payload})});default:return e}},$=Object(Y.b)({photos:q,auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_TOKEN":return Object(B.a)(Object(B.a)({},e),{},{token:t.payload});case"SET_PROFILE_MI":return Object(B.a)(Object(B.a)({},e),{},{profileMi:t.payload});case"SET_IS_AUTH":return Object(B.a)(Object(B.a)({},e),{},{isAuth:t.payload});case"SET_ERR":return Object(B.a)(Object(B.a)({},e),{},{err:t.payload});case"SET_LOGOUT":return Object(B.a)(Object(B.a)({},e),{},{isAuth:!1,profileMi:null});case"SET_ACTIVE_MENU_AVATAR":return Object(B.a)(Object(B.a)({},e),{},{activeMenuAvatar:t.payload});default:return e}}}),Z=Object(Y.c)($,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(S.a,null,r.a.createElement(p.a,{store:Z},r.a.createElement(K,null)))),document.getElementById("root")),window.store=Z,"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[37,1,2]]]);
//# sourceMappingURL=main.900bc981.chunk.js.map